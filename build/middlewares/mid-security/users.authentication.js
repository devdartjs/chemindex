import jwt from"jsonwebtoken";import User from"../../models/user.model.js";import{JWT_SECRET}from"../../config/config.env.js";export const authentication=(r,e,o)=>{const s=r.cookies.jwt;s?jwt.verify(s,JWT_SECRET,(r,s)=>{if(r)return e.redirect("/login");e.locals.user._id={_id:s.id},o()}):e.redirect("/login")};export const checkUser=async(r,e,o)=>{const s=r.cookies.jwt;if(!s)return e.locals.user=null,r.user=null,o();jwt.verify(s,JWT_SECRET,async(s,t)=>{if(s)return e.locals.user=null,r.user=null,o();try{const s=await User.findById(t.id);return e.locals.user=s,r.user=s,o()}catch(s){return e.locals.user=null,r.user=null,o()}})};