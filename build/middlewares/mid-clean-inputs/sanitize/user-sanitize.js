import sanitizeHtml from"sanitize-html";export const sanitizeUsersInput=(s,e,t)=>{const i=["email","password"],o=[];try{for(const e of i)if(s.body[e]&&"string"==typeof s.body[e]){const t=s.body[e],i=sanitizeHtml(t,{allowedTags:[],allowedAttributes:{}}).trim();s.body[e]=i,t===i?console.log(`[sanitizeUsersInput] ‚úÖ Field '${e}' was already clean.`):console.log(`[sanitizeUsersInput] üîß Field '${e}' was sanitized.`),o.push(e)}return 0===o.length&&console.log("[sanitizeUsersInput] ‚ö†Ô∏è No user fields were sanitized."),t()}catch(s){return console.error("Error sanitizing user fields:",s),e.status(500).json({error:"Failed to sanitize user fields",details:s.message})}};