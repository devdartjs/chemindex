import escape from"escape-html";const escapeFields=["casNumber","reagentName","description","classe","brand","classification","local","volume","weight","molecularFormula","molecularWeight_g_per_mol","furtherInformations"];export const escapeReagentInput=(e,o,t)=>{try{for(const o of escapeFields)e.body[o]&&"string"==typeof e.body[o]&&(e.body[o]=escape(e.body[o]));return Array.isArray(e.body.information)&&(e.body.information=e.body.information.map(e=>"string"==typeof e?escape(e):e)),Array.isArray(e.body.composition)&&(e.body.composition=e.body.composition.map(e=>({substance:e.substance&&"string"==typeof e.substance?escape(e.substance):"",concentration:e.concentration&&"string"==typeof e.concentration?escape(e.concentration):""}))),t()}catch(e){return console.error("Error escaping reagent fields:",e),o.status(500).json({error:"Failed to escape reagent fields",details:e.message})}};export default escapeReagentInput;