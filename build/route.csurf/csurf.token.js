import{Router}from"express";import csrfProtection from"../middlewares/mid-security/csrf.create.token.js";import csrfErrorHandler from"../middlewares/mid-security/csrf.error.handler.js";const csrfRouter=Router();csrfRouter.get("/csrf-token",csrfProtection,csrfErrorHandler,(r,e)=>{try{const o=r.csrfToken();if(!o)return console.error("CSRF token not found in request."),e.status(400).json({error:"CSRF token not found"});console.log("CSRF Token generated:",o),e.status(200).json({csrf:o})}catch(r){console.error("Error generating CSRF token:",r),e.status(500).json({error:"Internal Server Error"})}finally{console.log("CSRF token request completed.")}});export default csrfRouter;