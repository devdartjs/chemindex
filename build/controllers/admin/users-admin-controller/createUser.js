import User from"../../../models/user-model.js";import bcrypt from"bcryptjs";const createUser=async(s,e)=>{try{const{email:t,password:r}=s.body;if(!t||"string"!=typeof t||!r||"string"!=typeof r)return e.status(400).json({message:"Invalid input data"});const a=t.trim().toLowerCase();if(r.length<6)return e.status(400).json({message:"Password must be at least 6 characters long"});if(await User.findOne({email:a}).lean())return e.status(400).json({message:"User already exists"});const o=await bcrypt.hash(r,10),n=await User.create({email:a,password:o});if(!n)throw new Error("Error while creating new user");const{...i}=n.toObject();return e.status(201).json({user:i})}catch(s){return e.status(500).json({error:s.message})}};export default createUser;