import User from"../../../models/user-model.js";import{handleErrors}from"../../../middlewares/mid-functions/error-handler.js";import createToken from"../../../middlewares/mid-functions/creat-token.js";export const loginAdmin=async(r,s)=>{const{email:e,password:o}=r.body;try{const r=await User.login(e,o);if("admin"!==r.status)throw new Error("Admin permissions required");if(r){const e=createToken(r._id);return s.cookie("jwt",e,{httpOnly:!0,maxAge:864e5}),s.status(200).json({user:r,token:e,nonce:s.locals.nonce})}throw new Error("incorrect password")}catch(r){const e=handleErrors(r);if("incorrect email"===r.message)return s.status(400).json({errors:{email:e.email}});if("incorrect password"===r.message)return s.status(400).json({errors:{password:e.password}})}};