import User from"../../models/user-model.js";import{handleErrors}from"../../middlewares/mid-functions/error-handler.js";import createToken from"../../middlewares/mid-functions/creat-token.js";export const signUp=async(r,e)=>{try{const{email:s,password:t}=r.body;if(!s||!t)return e.status(400).json({error:"Email and password are required"});const o=String(s).trim().toLowerCase(),a=String(t).trim();if(a.length<6)return e.status(400).json({error:"Password must be at least 6 characters long"});const n=await User.create({email:o,password:a}),i=createToken(n._id);return e.cookie("jwt",i,{httpOnly:!0,secure:"production"===process.env.NODE_ENV,sameSite:"strict",maxAge:864e5}),e.status(201).json({user:n})}catch(r){if(11e3===r.code)return e.status(400).json({errors:{email:"This email is already registered"}});const s=handleErrors(r);return e.status(400).json({errors:s})}};