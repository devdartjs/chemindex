import Reagent from"../../models/reagents-model.js";const createReagent=async(e,t)=>{try{const s=t.locals.user?._id;if(!s)return t.status(401).json({message:"User not allowed."});const a=await Reagent.find({userId:s,createdBy:s});if(!a)return t.status(400).json({message:"There is no reagents here!"});if(a.length>=16)return t.status(403).json({message:"To create more reagents, you need to update your account. Please fill out the waiting list form.",redirect:"wainting-list-form"});const{casNumber:r}=e.body;if(!r)return t.status(400).json({message:"Invalid casNumber"});if(await Reagent.findOne({casNumber:r.trim(),createdBy:s}))return t.status(400).json({message:"Reagent already exists!"});const n=await Reagent.create({...e.body,createdBy:s});return t.status(201).json({reagent:n})}catch(e){return t.status(500).json({message:"Server Error",err:e.message})}};export default createReagent;