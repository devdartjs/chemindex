import aj from"../config/config.arcjet.js";const arcjetMiddleware=async(e,o,r)=>{try{const s=await aj.protect(e,{requested:1});if("production"!==process.env.NODE_ENV&&console.log(`[Arcjet] Decision: ${JSON.stringify(s)}`),s.isDenied())return console.log(`[Arcjet] isDenied: ${s.isDenied()}, Reason: ${s.reason?.kind}`),s.reason.isRateLimit()?o.status(429).json({error:"Too many requests"}):s.reason.isBot()?o.status(403).json({error:"No bots allowed"}):o.status(403).json({error:"Access denied"});r()}catch(e){if(console.log(`Arcjet Middleware Error: ${e}`),"production"===process.env.NODE_ENV)return o.status(503).json({error:"Security service unavailable"});r(e)}};