import aj from"../config/config.arcjet.js";const arcjetMiddleware=async(e,r,o)=>{try{const s=await aj.protect(e,{requested:1});if("production"!==process.env.NODE_ENV&&console.log(`[Arcjet] Decision: ${JSON.stringify(s)}`),s.isDenied())return console.log(`[Arcjet] isDenied: ${s.isDenied()}, Reason: ${s.reason?.kind}`),s.reason.isRateLimit()?r.status(429).json({error:"Too many requests"}):s.reason.isBot()?r.status(403).json({error:"No bots allowed"}):r.status(403).json({error:"Access denied"});o()}catch(e){if(console.log(`Arcjet Middleware Error: ${e}`),"production"===process.env.NODE_ENV)return r.status(503).json({error:"Security service unavailable"});o(e)}};export default arcjetMiddleware;