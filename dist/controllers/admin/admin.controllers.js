import User from"../../models/user.model.js";import{handleErrors}from"../../mid-functions/error.handler.js";import createToken from"../../mid-functions/creat.token.js";export const getAdminPage=async(o,s)=>{s.status(200).json({message:"Render Admin Page",user:s.locals.user._id,status:s.locals.user.status,nonce:s.locals.nonce})};export const loginAdmin=async(o,s)=>{const{email:r,password:e}=o.body;console.log("console.log-loginAdminControl (1)",r,e);try{const o=await User.login(r,e);if("admin"!==o.status)throw new Error("Admin permissions required");if(o){const r=createToken(o._id);return s.cookie("jwt",r,{httpOnly:!0,maxAge:864e5}),console.log("login admin token:",r),s.status(200).json({user:o,token:r,nonce:s.locals.nonce})}throw new Error("incorrect password")}catch(o){const r=handleErrors(o);if("incorrect email"===o.message)return s.status(400).json({errors:{email:r.email}});if("incorrect password"===o.message)return s.status(400).json({errors:{password:r.password}})}console.log(s.locals.user)};