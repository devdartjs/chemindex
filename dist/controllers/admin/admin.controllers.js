import User from"../../models/user.model.js";import{handleErrors}from"../../mid-functions/error.handler.js";import createToken from"../../mid-functions/creat.token.js";export const getAdminPage=async(s,r)=>{r.status(200).json({message:"Render Admin Page",user:r.locals.user._id,status:r.locals.user.status,nonce:r.locals.nonce})};export const loginAdmin=async(s,r)=>{const{email:e,password:o}=s.body;try{const s=await User.login(e,o);if("admin"!==s.status)throw new Error("Admin permissions required");if(s){const e=createToken(s._id);return r.cookie("jwt",e,{httpOnly:!0,maxAge:864e5}),r.status(200).json({user:s,token:e,nonce:r.locals.nonce})}throw new Error("incorrect password")}catch(s){const e=handleErrors(s);if("incorrect email"===s.message)return r.status(400).json({errors:{email:e.email}});if("incorrect password"===s.message)return r.status(400).json({errors:{password:e.password}})}};