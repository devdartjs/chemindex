import{Router}from"express";import csrfProtection from"../mid-security/csrf.create.token.js";import csrfErrorHandler from"../mid-security/csrf.error.handler.js";const csrfRouter=Router();csrfRouter.get("/csrf-token",csrfProtection,csrfErrorHandler,(r,o)=>{try{const e=r.csrfToken();if(!e)return console.error("CSRF token not found in request."),o.status(400).json({error:"CSRF token not found"});console.log("CSRF Token generated:",e),o.status(200).json({csrf:e})}catch(r){console.error("Error generating CSRF token:",r),o.status(500).json({error:"Internal Server Error"})}finally{console.log("CSRF token request completed.")}});export default csrfRouter;